[build]
  command = "pnpm install --frozen-lockfile && pnpm run prisma:generate && pnpm run build"
  publish = ".next"

[build.environment]
  NODE_VERSION = "20"
  PNPM_VERSION = "9"
  # Desabilita smart detection para Firebase API Key (pública por natureza)
  SECRETS_SCAN_SMART_DETECTION_ENABLED = "false"

[scheduled.functions]
  # Daily reconciliation at 02:00 UTC
  finance_reconcile_daily = { schedule = "0 2 * * *" }
  # Daily summary cache at 02:10 UTC
  finance_summary_daily = { schedule = "10 2 * * *" }
  # Monthly projection on the 25th at 02:20 UTC
  finance_projection_monthly = { schedule = "20 2 25 * *" }

# Headers definidos em public/_headers

# Redirects básicos
[[redirects]]
  from = "/health"
  to = "/api/health"
  status = 200

[[plugins]]
  package = "@netlify/plugin-nextjs"
